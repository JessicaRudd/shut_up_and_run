(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4477:(e,a,t)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),!function(e,a){for(var t in a)Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}(a,{callServer:function(){return r.callServer},createServerReference:function(){return l},findSourceMapURL:function(){return s.findSourceMapURL}});let r=t(3806),s=t(1818),l=t(4979).createServerReference},7387:(e,a,t)=>{Promise.resolve().then(t.bind(t,7678))},7678:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>et});var r=t(5155),s=t(8778),l=t(933),n=t(8856),i=t(6695),c=t(285),o=t(6874),d=t.n(o),h=t(6462),m=t(1949),u=t(2115),x=t(4477);let p=(0,x.createServerReference)("40656054b3a7023f7ad00e35130ec5cd25b9580b11",x.callServer,void 0,x.findSourceMapURL,"customizeNewsletter");var f=t(3533),g=t(6203);let y={setItem:(e,a)=>{try{localStorage.setItem(e,a)}catch(e){console.warn("[WeatherService] Could not write to localStorage:",e)}}};async function j(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"imperial";if(!e)throw Error("Location is required");try{let t=(0,g.xI)().currentUser;if(!t)throw Error("User must be authenticated");let r=await t.getIdToken(),s=await fetch("https://us-central1-shut-up-and-run.cloudfunctions.net/weather-getData?location=".concat(encodeURIComponent(e),"&unit=").concat(a),{method:"GET",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to fetch weather data")}let l=await s.json();return y.setItem("weather_".concat(e,"_").concat(a),JSON.stringify({data:l,timestamp:Date.now()})),l}catch(e){throw console.error("[WeatherService] Error fetching weather data:",e),e}}var w=t(157);let N=(0,w.A)("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);function v(e){let{greetingWithName:a}=e;return a?(0,r.jsxs)(i.Zp,{className:"shadow-md bg-gradient-to-r from-primary/10 via-accent/5 to-background",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{className:"flex items-center text-2xl font-semibold",children:[(0,r.jsx)(N,{className:"mr-2 h-7 w-7 text-primary"}),"Daily Motivation"]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("p",{className:"text-lg",children:a})})]}):(0,r.jsxs)(i.Zp,{className:"shadow-md bg-gradient-to-r from-primary/10 via-accent/5 to-background",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{className:"flex items-center text-2xl font-semibold",children:[(0,r.jsx)(N,{className:"mr-2 h-7 w-7 text-primary"}),"Daily Motivation"]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("p",{className:"text-lg text-muted-foreground",children:"Personalized greeting will appear here once available."})})]})}let b=(0,w.A)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),k=(0,w.A)("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),S=(0,w.A)("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),A=(0,w.A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),P=e=>{if(!e)return(0,r.jsx)(b,{className:"mr-2 h-6 w-6 text-gray-400"});let a=e.toLowerCase();return a.includes("sun")||a.includes("clear")?(0,r.jsx)(k,{className:"mr-2 h-6 w-6 text-yellow-500"}):a.includes("cloud")?(0,r.jsx)(S,{className:"mr-2 h-6 w-6 text-sky-500"}):a.includes("rain")||a.includes("drizzle")||a.includes("shower")?(0,r.jsx)(A,{className:"mr-2 h-6 w-6 text-blue-500"}):a.includes("snow")?(0,r.jsx)(A,{className:"mr-2 h-6 w-6 text-blue-300"}):a.includes("unavailable")||a.includes("error")?(0,r.jsx)(b,{className:"mr-2 h-6 w-6 text-destructive"}):(0,r.jsx)(A,{className:"mr-2 h-6 w-6 text-gray-500"})};function C(e){let{location:a,weatherString:t}=e;if(!a)return(0,r.jsxs)(i.Zp,{className:"shadow-md",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(k,{className:"mr-2 h-6 w-6 text-yellow-400"}),"Local Weather & Run Recommendation"]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"Please set your location in the profile to see local weather and running recommendations."})})]});let s=t||"Weather information is currently being processed or is unavailable.";return(0,r.jsxs)(i.Zp,{className:"shadow-md min-h-[200px]",children:[" ",(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{className:"flex items-center text-xl font-semibold",children:[P(s),"Weather in ",a]})}),(0,r.jsxs)(i.Wu,{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-base whitespace-pre-line",children:s}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground italic pt-2",children:"Forecast details and running recommendation powered by AI using OpenWeatherMap data."})]})]})}var M=t(1950),O=t(2085),R=t(9434);let W=(0,O.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Z=u.forwardRef((e,a)=>{let{className:t,variant:s,...l}=e;return(0,r.jsx)("div",{ref:a,role:"alert",className:(0,R.cn)(W({variant:s}),t),...l})});Z.displayName="Alert";let D=u.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("h5",{ref:a,className:(0,R.cn)("mb-1 font-medium leading-none tracking-tight",t),...s})});D.displayName="AlertTitle";let E=u.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,R.cn)("text-sm [&_p]:leading-relaxed",t),...s})});function T(e){var a;let{userProfile:t,workoutSuggestion:s,planEndNotification:l}=e,[n,o]=(0,u.useState)(!1),[x,p]=(0,u.useState)(!1);return((0,u.useEffect)(()=>{t&&(o((0,f.Aq)(t)),p((0,f.UY)(t)))},[t]),t&&t.name)?(0,r.jsxs)(i.Zp,{className:"shadow-md",children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsxs)(i.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(h.A,{className:"mr-2 h-6 w-6 text-primary"}),"Today's Workout"]}),t.trainingPlan&&(0,r.jsxs)(i.BT,{children:["Part of your ",(null===(a=M.CY.find(e=>e.value===t.trainingPlan))||void 0===a?void 0:a.label)||"training plan","."]})]}),(0,r.jsxs)(i.Wu,{className:"space-y-4",children:[(0,r.jsx)("p",{className:"text-lg",children:s||"Today's workout details are being prepared..."}),l&&(0,r.jsxs)(Z,{variant:"default",className:"bg-accent/20 border-accent text-accent-foreground",children:[(0,r.jsx)(m.A,{className:"h-5 w-5 text-accent"}),(0,r.jsx)(D,{children:"Training Plan Update"}),(0,r.jsx)(E,{children:l})]}),!l&&n&&(0,r.jsxs)(Z,{variant:"default",className:"bg-accent/20 border-accent text-accent-foreground",children:[(0,r.jsx)(m.A,{className:"h-5 w-5 text-accent"}),(0,r.jsx)(D,{children:"Plan Ending Soon!"}),(0,r.jsxs)(E,{children:["Your current training plan is about to end. Head to your",(0,r.jsx)(d(),{href:"/profile",className:"font-semibold underline hover:text-primary ml-1",children:"profile"})," to set up a new one and keep crushing your goals!"]})]}),!l&&x&&(0,r.jsxs)(Z,{variant:"default",className:"bg-primary/10 border-primary text-primary",children:[(0,r.jsx)(m.A,{className:"h-5 w-5 text-primary"}),(0,r.jsx)(D,{children:"Plan Completed!"}),(0,r.jsxs)(E,{className:"flex flex-col gap-2 text-primary-foreground",children:[(0,r.jsx)("span",{className:"text-primary",children:"Congratulations on finishing your training plan! Time to set a new goal?"}),(0,r.jsx)(c.$,{asChild:!0,size:"sm",className:"w-fit bg-primary hover:bg-primary/90 text-primary-foreground",children:(0,r.jsx)(d(),{href:"/profile",children:"Update Your Profile"})})]})]})]})]}):(0,r.jsxs)(i.Zp,{className:"shadow-md",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(h.A,{className:"mr-2 h-6 w-6 text-primary"}),"Today's Workout"]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"Workout details will appear here once your profile is set up."})})]})}E.displayName="AlertDescription";var U=t(6424);let I=(0,w.A)("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]),B=(0,w.A)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function L(e){let{topStories:a}=e;if(!a||0===a.length)return(0,r.jsxs)(i.Zp,{className:"shadow-md",children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsxs)(i.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(I,{className:"mr-2 h-6 w-6 text-primary"}),"Top Running News"]}),(0,r.jsx)(i.BT,{children:"Curated just for you."})]}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"No news stories available at the moment, or still loading."})})]});let t=[...a].sort((e,a)=>e.priority-a.priority);return(0,r.jsxs)(i.Zp,{className:"shadow-md",children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsxs)(i.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(I,{className:"mr-2 h-6 w-6 text-primary"}),"Top Running News"]}),(0,r.jsx)(i.BT,{children:"Curated just for you."})]}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)(U.F,{className:"h-[300px] pr-4",children:(0,r.jsx)("ul",{className:"space-y-4",children:t.map((e,a)=>(0,r.jsxs)("li",{className:"pb-3 border-b border-border last:border-b-0",children:[(0,r.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"group",children:(0,r.jsxs)("h3",{className:"font-semibold text-md group-hover:text-primary group-hover:underline flex items-center",children:[e.title,(0,r.jsx)(B,{className:"ml-1 h-3 w-3 opacity-50 group-hover:opacity-100 transition-opacity"})]})}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.summary})]},a))})})})]})}let z=(0,w.A)("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),Y=(0,w.A)("Glasses",[["circle",{cx:"6",cy:"15",r:"4",key:"vux9w4"}],["circle",{cx:"18",cy:"15",r:"4",key:"18o8ve"}],["path",{d:"M14 15a2 2 0 0 0-2-2 2 2 0 0 0-2 2",key:"1ag4bs"}],["path",{d:"M2.5 13 5 7c.7-1.3 1.4-2 3-2",key:"1hm1gs"}],["path",{d:"M21.5 13 19 7c-.7-1.3-1.5-2-3-2",key:"1r31ai"}]]),_=(0,w.A)("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]),q=(0,w.A)("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]),H=(0,w.A)("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]),J=(0,w.A)("Hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]),V=(0,w.A)("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),F={hat:z,visor:k,sunglasses:Y,headband:z,shirt:_,"tank-top":_,"long-sleeve":_,"base-layer":_,"mid-layer":_,jacket:q,vest:_,windbreaker:q,"rain-jacket":H,shorts:h.A,capris:h.A,tights:h.A,pants:h.A,gloves:J,mittens:J,socks:h.A,shoes:h.A,gaiter:z,balaclava:z,accessory:V},G=e=>{let a=e.toLowerCase().trim().replace("-"," ");return F[a]?F[a]:a.includes("shirt")||a.includes("top")?_:a.includes("short")||a.includes("pant")||a.includes("tight")?h.A:a.includes("jacket")?q:a.includes("hat")||a.includes("cap")||a.includes("beanie")||a.includes("head")?z:F[a]||b};function $(e){let{suggestion:a}=e;return"string"==typeof a?(0,r.jsxs)(i.Zp,{className:"shadow-md",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(_,{className:"mr-2 h-6 w-6 text-primary"}),"Dress Your Run"]})}),(0,r.jsxs)(i.Wu,{children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:"Clothing suggestions are in an unexpected format."}),(0,r.jsxs)("p",{className:"text-sm mt-2",children:["Raw suggestion: ",a]})]})]}):a&&0!==a.length?(0,r.jsxs)(i.Zp,{className:"shadow-md",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(_,{className:"mr-2 h-6 w-6 text-primary"}),"Dress Your Run"]})}),(0,r.jsxs)(i.Wu,{children:[(0,r.jsx)("ul",{className:"space-y-3",children:a.map((e,a)=>{if("object"!=typeof e||!e||"string"!=typeof e.item||"string"!=typeof e.category)return(0,r.jsxs)("li",{className:"flex items-center text-base text-destructive",children:[(0,r.jsx)(b,{className:"mr-3 h-5 w-5 text-destructive shrink-0"}),(0,r.jsx)("span",{children:"Malformed clothing item data."})]},"malformed-".concat(a));let t=G(e.category);return(0,r.jsxs)("li",{className:"flex items-center text-base",children:[(0,r.jsx)(t,{className:"mr-3 h-5 w-5 text-primary shrink-0"}),(0,r.jsx)("span",{children:e.item})]},a)})}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground italic pt-3",children:"Based on conditions around the recommended run time."})]})]}):(0,r.jsxs)(i.Zp,{className:"shadow-md",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(_,{className:"mr-2 h-6 w-6 text-primary"}),"Dress Your Run"]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("p",{className:"text-muted-foreground",children:null===a?"Clothing suggestion is being generated...":"No specific clothing suggestions available at this time. This could be due to unavailable weather data or the AI not providing details."})})]})}var K=t(5388);let Q="cachedNewsletterData",X=e=>({name:e.name,location:e.location,weatherUnit:e.weatherUnit,runningLevel:e.runningLevel,trainingPlan:e.trainingPlan,planStartDate:e.planStartDate,raceDate:e.raceDate,newsSearchPreferences:e.newsSearchPreferences?[...e.newsSearchPreferences].sort():[]});function ee(){let{userProfile:e,loading:a,isProfileComplete:t}=(0,l.s)(),[s,i]=(0,u.useState)(null),[c,o]=(0,u.useState)(!0),[d,h]=(0,u.useState)(null),[x,g]=(0,u.useState)(null),y=(0,u.useCallback)(async(a,t)=>{if(!e.name||!e.location||!e.weatherUnit){console.log("[Orchestrator] Missing required profile data:",{name:!!e.name,location:!!e.location,weatherUnit:!!e.weatherUnit}),h("Please complete your profile including name, location, and weather unit to load the dashboard."),i(null),o(!1);return}o(!0),h(null),g(null),console.log("[Orchestrator] Starting to fetch fresh newsletter data for date:",a);try{let r;let s=(0,f.iy)(e);console.log("[Orchestrator] Today's workout:",s);let l="C"===e.weatherUnit?"metric":"imperial",n=await j(e.location,l);if(console.log("[Orchestrator] Weather service result:",n),"error"in n){let e="string"==typeof n.error?n.error:"Unknown error fetching weather data";console.warn("[Orchestrator] Weather service returned an error:",e),r={error:e},g(e)}else r=n;let c="General Fitness";if(e.trainingPlan){let a=M.CY.find(a=>a.value===e.trainingPlan);c=a?a.label.replace(" Plan","").replace(" Race",""):e.trainingPlan}let o={userName:e.name,location:e.location,runningLevel:e.runningLevel||"beginner",trainingPlanType:e.trainingPlan||"5k",raceDistance:c,workout:s,weather:r,weatherUnit:e.weatherUnit||"F",newsSearchPreferences:e.newsSearchPreferences||[]};console.log("[Orchestrator] Input for customizeNewsletter AI flow:",JSON.stringify(o,null,2));let d=await p(o);console.log("[Orchestrator] Result from customizeNewsletter AI flow:",JSON.stringify(d,null,2)),localStorage.setItem(Q,JSON.stringify({data:d,fetchedDate:a,profileSnapshot:t})),console.log("[Orchestrator] Newsletter data cached successfully with snapshot:",t),i(d)}catch(e){console.error("[Orchestrator] Error fetching newsletter data:",e),h(e.message||"Failed to fetch newsletter data"),o(!1)}},[e,g,o,h,i]);return((0,u.useEffect)(()=>{if(a){console.log("[Orchestrator] Waiting for user profile to load..."),o(!0);return}if(console.log("[Orchestrator] User profile loaded. isProfileComplete:",t,"Profile:",e),!t){console.log("[Orchestrator] Profile is not complete. Prompting user."),h("Please complete your profile fully (including name, location, weather unit, and training plan selections) to load the dashboard."),i(null),o(!1);return}d&&d.startsWith("Please complete your profile")&&(console.log("[Orchestrator] Profile is now complete, clearing previous 'incomplete profile' error."),h(null));let r=(0,K.GP)(new Date,"yyyy-MM-dd"),s=X(e),l=!1;console.log("[Orchestrator] useEffect for cache check. Today:",r),console.log("[Orchestrator] Current Profile Snapshot for cache check:",s);let n=localStorage.getItem(Q);if(n)try{var c;let e=JSON.parse(n);console.log("[Orchestrator] Found cached entry:",e);let a=e.profileSnapshot.name===s.name&&e.profileSnapshot.location===s.location&&e.profileSnapshot.weatherUnit===s.weatherUnit&&e.profileSnapshot.runningLevel===s.runningLevel&&e.profileSnapshot.trainingPlan===s.trainingPlan&&e.profileSnapshot.planStartDate===s.planStartDate&&e.profileSnapshot.raceDate===s.raceDate&&JSON.stringify(e.profileSnapshot.newsSearchPreferences)===JSON.stringify(s.newsSearchPreferences),t="string"==typeof(null===(c=e.data)||void 0===c?void 0:c.weather)&&(e.data.weather.toLowerCase().includes("unavailable")||e.data.weather.toLowerCase().includes("error")||e.data.weather.toLowerCase().includes("could not retrieve"));console.log("[Orchestrator] Cache check: Fetched Date Match: ".concat(e.fetchedDate===r," (Cached: ").concat(e.fetchedDate,", Today: ").concat(r,")")),console.log("[Orchestrator] Cache check: Profile Snapshots Match: ".concat(a)),console.log("[Orchestrator] Cache check: Weather Was Unavailable In Cache: ".concat(t)),e.fetchedDate===r&&a&&!t?(console.log("[Orchestrator] Using valid cached newsletter data for today (weather available)."),i(e.data),o(!1),h(null),l=!0):(console.log("[Orchestrator] Cache is stale or weather was unavailable/errored. Will attempt to fetch fresh data."),e.fetchedDate!==r&&console.log("  - Cache Invalidation Reason: Date mismatch (Cached: ".concat(e.fetchedDate,", Today: ").concat(r,")")),a||(console.log("  - Cache Invalidation Reason: Profile snapshot mismatch."),Object.keys(s).forEach(a=>{let t=s[a],r=e.profileSnapshot[a];JSON.stringify(t)!==JSON.stringify(r)&&console.log("    Mismatch on key '".concat(a,"': Current='").concat(JSON.stringify(t),"', Cached='").concat(JSON.stringify(r),"'"))})),t&&console.log("  - Cache Invalidation Reason: Cached weather was unavailable or errored. Attempting refresh."))}catch(e){console.error("[Orchestrator] Error parsing cached newsletter data:",e),localStorage.removeItem(Q)}else console.log("[Orchestrator] No cache found. Will fetch fresh data.");l||(console.log("[Orchestrator] Proceeding to fetch fresh newsletter data because cache was not used."),y(r,s))},[a,t,e,y,d]),a||c&&!s&&!d)?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(n.E,{className:"h-28 w-full"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(n.E,{className:"h-64 w-full"}),(0,r.jsx)(n.E,{className:"h-48 w-full"})]}),(0,r.jsx)(n.E,{className:"h-48 w-full"}),(0,r.jsx)(n.E,{className:"h-72 w-full"})]}):d?(0,r.jsxs)(Z,{variant:"destructive",className:"mt-6",children:[(0,r.jsx)(m.A,{className:"h-5 w-5"}),(0,r.jsx)(D,{children:"Error Loading Dashboard"}),(0,r.jsx)(E,{children:d})]}):c||s?s?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(v,{greetingWithName:s.greeting}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(C,{location:e.location,weatherString:s.weather}),(0,r.jsx)(T,{userProfile:e,workoutSuggestion:s.workout,planEndNotification:s.planEndNotification})]}),(0,r.jsx)($,{suggestion:s.dressMyRunSuggestion}),(0,r.jsx)(L,{topStories:s.topStories})]}):(0,r.jsx)("div",{className:"text-center py-10",children:"Preparing your dashboard... If this takes too long, please refresh or check back later."}):(0,r.jsxs)(Z,{variant:"default",className:"mt-6 border-primary/50 text-primary-foreground bg-primary/10",children:[(0,r.jsx)(m.A,{className:"h-5 w-5 text-primary"}),(0,r.jsx)(D,{className:"text-primary",children:"Dashboard Content Unavailable"}),(0,r.jsxs)(E,{className:"text-foreground",children:["We are having trouble generating your personalized content at the moment. This could be due to:",(0,r.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,r.jsx)("li",{children:"Your profile not being fully completed (check all fields, especially name, location, weather unit, and training plan selections)."}),(0,r.jsx)("li",{children:"Temporary issues with external services (weather, news search). Please ensure API keys are correctly set in the environment if you are the developer."}),(0,r.jsx)("li",{children:"Temporary issues with the AI content generation service."})]}),"Please ensure your profile is complete and try refreshing. If the issue persists, please try again later.",x&&(0,r.jsxs)("p",{className:"mt-2 font-semibold",children:["Specific weather service message: ",x]})]})]})}var ea=t(283);function et(){let{loading:e,isProfileComplete:a}=(0,l.s)(),{user:t}=(0,ea.A)();return e?(0,r.jsx)(s.O,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(n.E,{className:"h-28 w-full"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsx)(n.E,{className:"h-48 w-full"}),(0,r.jsx)(n.E,{className:"h-48 w-full"})]}),(0,r.jsx)(n.E,{className:"h-72 w-full"})]})}):t?a?(0,r.jsx)(s.O,{children:(0,r.jsx)(ee,{})}):(0,r.jsx)(s.O,{children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-200px)]",children:(0,r.jsxs)(i.Zp,{className:"w-full max-w-md text-center shadow-xl",children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsx)(m.A,{className:"mx-auto h-12 w-12 text-primary"}),(0,r.jsx)(i.ZB,{className:"text-2xl mt-4",children:"Complete Your Profile"}),(0,r.jsx)(i.BT,{className:"mt-2",children:"To get your personalized running dashboard, please complete your profile with all required fields."})]}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)(c.$,{asChild:!0,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:(0,r.jsx)(d(),{href:"/profile",children:"Complete Your Profile"})})})]})})}):(0,r.jsx)(s.O,{children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-200px)]",children:(0,r.jsxs)(i.Zp,{className:"w-full max-w-md text-center shadow-xl",children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsx)(h.A,{className:"mx-auto h-12 w-12 text-primary"}),(0,r.jsx)(i.ZB,{className:"text-2xl mt-4",children:"Welcome to Shut Up and Run!"}),(0,r.jsx)(i.BT,{className:"mt-2",children:"Your personalized running companion. Sign up or log in to get started."})]}),(0,r.jsxs)(i.Wu,{className:"space-y-4",children:[(0,r.jsx)(c.$,{asChild:!0,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:(0,r.jsx)(d(),{href:"/signup",children:"Create Account"})}),(0,r.jsx)(c.$,{asChild:!0,variant:"outline",className:"w-full",children:(0,r.jsx)(d(),{href:"/login",children:"Sign In"})})]})]})})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[992,965,845,442,244,234,188,13,380,960,441,684,358],()=>a(7387)),_N_E=e.O()}]);