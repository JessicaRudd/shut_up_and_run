(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3533:(e,a,t)=>{"use strict";t.d(a,{Aq:()=>f,Qg:()=>p,UY:()=>x,iy:()=>m});var r=t(1950),s=t(9233),n=t(644),l=t(9140),o=t(7608),i=t(831);let c=e=>"saturday"===e?6:6*("sunday"!==e),d=(e,a)=>{let t=Array(7).fill("Rest"),r=0;for(let s of(e>0&&(t[a]="LongRun",r++),r<e&&("Rest"===t[2]?(t[2]="Interval",r++):"Rest"===t[3]&&(t[3]="Interval",r++)),r<e&&("Rest"===t[4]?(t[4]="Tempo",r++):"Rest"===t[3]?"Rest"===t[3]&&(t[3]="Tempo",r++):"Rest"===t[5]&&"Rest"===t[5]&&(t[5]="Tempo",r++)),[1,3,5,0,2,4,6]))r<e&&"Rest"===t[s]&&(t[s]="EasyRun",r++);if(r<e)for(let a=0;a<7&&r<e;a++)"Rest"===t[a]&&(t[a]="EasyRun",r++);return t},h=function(e,a,t,r,s,n){let l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7?arguments[7]:void 0;if(l)return"RACE DAY! Good luck with your ".concat(r,"! Remember your strategy and enjoy the experience!");let i=!1;n&&void 0!==o&&(n.durationWeeks>=12&&o<=14?i=!0:n.durationWeeks>=8&&o<=7&&(i=!0));let c="Week ".concat(a,", Day ").concat(s," of your ").concat(r,": ");switch(e){case"LongRun":let d=("beginner"===t?30:"intermediate"===t?45:60)+a*("beginner"===t?5:"intermediate"===t?7:10);d=Math.min(d,r.includes("Ultra")?240:r.includes("Marathon")?180:r.includes("Half")?120:90),i&&(d=Math.max(30,Math.floor(.5*d))),c+="Long Run: ".concat(d," minutes at an easy, sustainable pace.");break;case"Interval":let h="beginner"===t?4:"intermediate"===t?6:8;i&&(h=Math.max(2,Math.floor(.6*h))),c+="Interval Training: ".concat(h,"x400m at ").concat("beginner"===t?"controlled":"intermediate"===t?"moderate":"hard"," pace with recovery jogs. Warm up and cool down.");break;case"Tempo":let u="beginner"===t?15:"intermediate"===t?20:30;i&&(u=Math.max(10,Math.floor(.6*u))),c+="Tempo Run: ".concat(u," minutes at a comfortably hard pace. Include warm up and cool down.");break;case"EasyRun":let m="beginner"===t?20:"intermediate"===t?30:40;i&&void 0!==o&&o<=3?m=Math.max(15,Math.floor(.5*m)):i&&(m=Math.max(20,Math.floor(.7*m))),c+="Easy Run: ".concat(m," minutes at a conversational pace.");break;case"Rest":c+="Rest day or light cross-training (e.g., stretching, yoga). Focus on recovery.";break;default:c+="General training activity."}return i&&"Rest"!==e&&(c+=" (Tapering week - focus on feeling fresh!)"),c},u=(e,a,t,i)=>{let u;let m=r.CY.find(a=>a.value===e.trainingPlan),p=m?m.label:"your selected plan";if(!m)return{workout:"Training plan details not found.",isRestDay:!1,workoutType:"Rest"};let f=(0,s.P)(a),x=d(e.runningDaysPerWeek||DEFAULT_USER_PROFILE.runningDaysPerWeek,c(e.longRunDay||DEFAULT_USER_PROFILE.longRunDay))[f],g=!1;if(e.raceDate&&e.planStartDate){let t=(0,n.o)(new Date(e.raceDate)),r=(0,n.o)(new Date(e.planStartDate));i===(0,l.m)(t,r)+1&&(0,o.x)(a,{representation:"date"})===(0,o.x)(t,{representation:"date"})&&(x="RaceDay",g=!0),u=(0,l.m)(t,a)}return{workout:h(x,t,e.runningLevel,p,i,m,g,u),isRestDay:"Rest"===x,workoutType:x,isRaceDay:g}},m=e=>{if(!e||!e.trainingPlan||!e.runningLevel||!e.planStartDate)return"Set your training plan, running level, and plan start date in your profile to see today's workout.";let a=r.CY.find(a=>a.value===e.trainingPlan);if(!a)return"Selected training plan details not found.";let t=(0,n.o)(new Date(e.planStartDate)),s=(0,n.o)(new Date),o=(0,l.m)(s,t)+1;if(o<=0)return"Your ".concat(a.label," starts on ").concat(t.toLocaleDateString(),". Get ready!");let i=Math.floor((o-1)/7)+1,c=7*a.durationWeeks;if(e.raceDate){let r=(0,n.o)(new Date(e.raceDate));if(o>(0,l.m)(r,t)+1)return"Your ".concat(a.label," concluded on ").concat(r.toLocaleDateString(),". Hope the race went well! Consider starting a new plan.")}else if(i>a.durationWeeks)return"Your ".concat(a.label," has finished! Congratulations! Consider starting a new plan.");let{workout:d}=u(e,s,i,o);return d},p=e=>{if(!e||!e.planStartDate||!e.trainingPlan||!e.runningLevel)return[];let a=r.CY.find(a=>a.value===e.trainingPlan);if(!a)return[];let t=[],s=(0,n.o)(new Date(e.planStartDate)),o=7*a.durationWeeks;if(e.raceDate){let a=(0,n.o)(new Date(e.raceDate)),t=(0,n.o)(new Date(e.planStartDate));if(a<t)return console.error("Race date cannot be before plan start date."),[];o=(0,l.m)(a,t)+1}for(let a=0;a<o;a++){let r=(0,i.f)(s,a),n=a+1,l=Math.floor(a/7)+1,{workout:o,isRestDay:c,isRaceDay:d}=u(e,r,l,n);t.push({date:r,workout:o,dayOfPlan:n,weekOfPlan:l,isRestDay:c,isRaceDay:d})}return t},f=e=>{if(!e||!e.planStartDate||!e.trainingPlan)return!1;let a=r.CY.find(a=>a.value===e.trainingPlan);if(!a)return!1;let t=(0,n.o)(new Date(e.planStartDate)),s=7*a.durationWeeks;if(e.raceDate){let a=(0,n.o)(new Date(e.raceDate));if(a<t)return!1;s=(0,l.m)(a,t)+1}let o=(0,i.f)(t,s-1),c=(0,n.o)(new Date),d=(0,l.m)(o,c);return d<=7&&d>=0},x=e=>{if(!e||!e.planStartDate||!e.trainingPlan)return!1;let a=r.CY.find(a=>a.value===e.trainingPlan);if(!a)return!1;let t=(0,n.o)(new Date(e.planStartDate)),s=7*a.durationWeeks;if(e.raceDate){let a=(0,n.o)(new Date(e.raceDate));if(a<t)return!1;s=(0,l.m)(a,t)+1}let o=(0,i.f)(t,s-1);return(0,n.o)(new Date)>o}},4477:(e,a,t)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),!function(e,a){for(var t in a)Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}(a,{callServer:function(){return r.callServer},createServerReference:function(){return n},findSourceMapURL:function(){return s.findSourceMapURL}});let r=t(3806),s=t(1818),n=t(4979).createServerReference},5369:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>X});var r=t(5155),s=t(8778),n=t(933),l=t(8856),o=t(6695),i=t(285),c=t(6874),d=t.n(c),h=t(1949),u=t(2115),m=t(4477);let p=(0,m.createServerReference)("40656054b3a7023f7ad00e35130ec5cd25b9580b11",m.callServer,void 0,m.findSourceMapURL,"customizeNewsletter");var f=t(3533);let x=(0,m.createServerReference)("609c75b2846fdf234a035f067d7f3d249b009af633",m.callServer,void 0,m.findSourceMapURL,"getWeatherByLocation");var g=t(157);let y=(0,g.A)("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);function w(e){let{greetingWithName:a}=e;return a?(0,r.jsxs)(o.Zp,{className:"shadow-md bg-gradient-to-r from-primary/10 via-accent/5 to-background",children:[(0,r.jsx)(o.aR,{children:(0,r.jsxs)(o.ZB,{className:"flex items-center text-2xl font-semibold",children:[(0,r.jsx)(y,{className:"mr-2 h-7 w-7 text-primary"}),"Daily Motivation"]})}),(0,r.jsx)(o.Wu,{children:(0,r.jsx)("p",{className:"text-lg",children:a})})]}):(0,r.jsxs)(o.Zp,{className:"shadow-md bg-gradient-to-r from-primary/10 via-accent/5 to-background",children:[(0,r.jsx)(o.aR,{children:(0,r.jsxs)(o.ZB,{className:"flex items-center text-2xl font-semibold",children:[(0,r.jsx)(y,{className:"mr-2 h-7 w-7 text-primary"}),"Daily Motivation"]})}),(0,r.jsx)(o.Wu,{children:(0,r.jsx)("p",{className:"text-lg text-muted-foreground",children:"Personalized greeting will appear here once available."})})]})}let j=(0,g.A)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),v=(0,g.A)("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),N=(0,g.A)("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),b=(0,g.A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),k=e=>{if(!e)return(0,r.jsx)(j,{className:"mr-2 h-6 w-6 text-gray-400"});let a=e.toLowerCase();return a.includes("sun")||a.includes("clear")?(0,r.jsx)(v,{className:"mr-2 h-6 w-6 text-yellow-500"}):a.includes("cloud")?(0,r.jsx)(N,{className:"mr-2 h-6 w-6 text-sky-500"}):a.includes("rain")||a.includes("drizzle")||a.includes("shower")?(0,r.jsx)(b,{className:"mr-2 h-6 w-6 text-blue-500"}):a.includes("snow")?(0,r.jsx)(b,{className:"mr-2 h-6 w-6 text-blue-300"}):a.includes("unavailable")||a.includes("error")?(0,r.jsx)(j,{className:"mr-2 h-6 w-6 text-destructive"}):(0,r.jsx)(b,{className:"mr-2 h-6 w-6 text-gray-500"})};function S(e){let{location:a,weatherString:t}=e;if(!a)return(0,r.jsxs)(o.Zp,{className:"shadow-md",children:[(0,r.jsx)(o.aR,{children:(0,r.jsxs)(o.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(v,{className:"mr-2 h-6 w-6 text-yellow-400"}),"Local Weather & Run Recommendation"]})}),(0,r.jsx)(o.Wu,{children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"Please set your location in the profile to see local weather and running recommendations."})})]});let s=t||"Weather information is currently being processed or is unavailable.";return(0,r.jsxs)(o.Zp,{className:"shadow-md min-h-[200px]",children:[" ",(0,r.jsx)(o.aR,{children:(0,r.jsxs)(o.ZB,{className:"flex items-center text-xl font-semibold",children:[k(s),"Weather in ",a]})}),(0,r.jsxs)(o.Wu,{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-base whitespace-pre-line",children:s}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground italic pt-2",children:"Forecast details and running recommendation powered by AI using OpenWeatherMap data."})]})]})}var R=t(6462),D=t(1950),M=t(2085),P=t(9434);let A=(0,M.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),C=u.forwardRef((e,a)=>{let{className:t,variant:s,...n}=e;return(0,r.jsx)("div",{ref:a,role:"alert",className:(0,P.cn)(A({variant:s}),t),...n})});C.displayName="Alert";let O=u.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("h5",{ref:a,className:(0,P.cn)("mb-1 font-medium leading-none tracking-tight",t),...s})});O.displayName="AlertTitle";let W=u.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,P.cn)("text-sm [&_p]:leading-relaxed",t),...s})});function L(e){var a;let{userProfile:t,workoutSuggestion:s,planEndNotification:n}=e,[l,c]=(0,u.useState)(!1),[m,p]=(0,u.useState)(!1);return((0,u.useEffect)(()=>{t&&(c((0,f.Aq)(t)),p((0,f.UY)(t)))},[t]),t&&t.name)?(0,r.jsxs)(o.Zp,{className:"shadow-md",children:[(0,r.jsxs)(o.aR,{children:[(0,r.jsxs)(o.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(R.A,{className:"mr-2 h-6 w-6 text-primary"}),"Today's Workout"]}),t.trainingPlan&&(0,r.jsxs)(o.BT,{children:["Part of your ",(null===(a=D.CY.find(e=>e.value===t.trainingPlan))||void 0===a?void 0:a.label)||"training plan","."]})]}),(0,r.jsxs)(o.Wu,{className:"space-y-4",children:[(0,r.jsx)("p",{className:"text-lg",children:s||"Today's workout details are being prepared..."}),n&&(0,r.jsxs)(C,{variant:"default",className:"bg-accent/20 border-accent text-accent-foreground",children:[(0,r.jsx)(h.A,{className:"h-5 w-5 text-accent"}),(0,r.jsx)(O,{children:"Training Plan Update"}),(0,r.jsx)(W,{children:n})]}),!n&&l&&(0,r.jsxs)(C,{variant:"default",className:"bg-accent/20 border-accent text-accent-foreground",children:[(0,r.jsx)(h.A,{className:"h-5 w-5 text-accent"}),(0,r.jsx)(O,{children:"Plan Ending Soon!"}),(0,r.jsxs)(W,{children:["Your current training plan is about to end. Head to your",(0,r.jsx)(d(),{href:"/profile",className:"font-semibold underline hover:text-primary ml-1",children:"profile"})," to set up a new one and keep crushing your goals!"]})]}),!n&&m&&(0,r.jsxs)(C,{variant:"default",className:"bg-primary/10 border-primary text-primary",children:[(0,r.jsx)(h.A,{className:"h-5 w-5 text-primary"}),(0,r.jsx)(O,{children:"Plan Completed!"}),(0,r.jsxs)(W,{className:"flex flex-col gap-2 text-primary-foreground",children:[(0,r.jsx)("span",{className:"text-primary",children:"Congratulations on finishing your training plan! Time to set a new goal?"}),(0,r.jsx)(i.$,{asChild:!0,size:"sm",className:"w-fit bg-primary hover:bg-primary/90 text-primary-foreground",children:(0,r.jsx)(d(),{href:"/profile",children:"Update Your Profile"})})]})]})]})]}):(0,r.jsxs)(o.Zp,{className:"shadow-md",children:[(0,r.jsx)(o.aR,{children:(0,r.jsxs)(o.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(R.A,{className:"mr-2 h-6 w-6 text-primary"}),"Today's Workout"]})}),(0,r.jsx)(o.Wu,{children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"Workout details will appear here once your profile is set up."})})]})}W.displayName="AlertDescription";var E=t(6424);let T=(0,g.A)("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]),Z=(0,g.A)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function U(e){let{topStories:a}=e;if(!a||0===a.length)return(0,r.jsxs)(o.Zp,{className:"shadow-md",children:[(0,r.jsxs)(o.aR,{children:[(0,r.jsxs)(o.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(T,{className:"mr-2 h-6 w-6 text-primary"}),"Top Running News"]}),(0,r.jsx)(o.BT,{children:"Curated just for you."})]}),(0,r.jsx)(o.Wu,{children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"No news stories available at the moment, or still loading."})})]});let t=[...a].sort((e,a)=>e.priority-a.priority);return(0,r.jsxs)(o.Zp,{className:"shadow-md",children:[(0,r.jsxs)(o.aR,{children:[(0,r.jsxs)(o.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(T,{className:"mr-2 h-6 w-6 text-primary"}),"Top Running News"]}),(0,r.jsx)(o.BT,{children:"Curated just for you."})]}),(0,r.jsx)(o.Wu,{children:(0,r.jsx)(E.F,{className:"h-[300px] pr-4",children:(0,r.jsx)("ul",{className:"space-y-4",children:t.map((e,a)=>(0,r.jsxs)("li",{className:"pb-3 border-b border-border last:border-b-0",children:[(0,r.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"group",children:(0,r.jsxs)("h3",{className:"font-semibold text-md group-hover:text-primary group-hover:underline flex items-center",children:[e.title,(0,r.jsx)(Z,{className:"ml-1 h-3 w-3 opacity-50 group-hover:opacity-100 transition-opacity"})]})}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.summary})]},a))})})})]})}let I=(0,g.A)("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),z=(0,g.A)("Glasses",[["circle",{cx:"6",cy:"15",r:"4",key:"vux9w4"}],["circle",{cx:"18",cy:"15",r:"4",key:"18o8ve"}],["path",{d:"M14 15a2 2 0 0 0-2-2 2 2 0 0 0-2 2",key:"1ag4bs"}],["path",{d:"M2.5 13 5 7c.7-1.3 1.4-2 3-2",key:"1hm1gs"}],["path",{d:"M21.5 13 19 7c-.7-1.3-1.5-2-3-2",key:"1r31ai"}]]),Y=(0,g.A)("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]),B=(0,g.A)("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]),F=(0,g.A)("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]),_=(0,g.A)("Hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]),H=(0,g.A)("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),V={hat:I,visor:v,sunglasses:z,headband:I,shirt:Y,"tank-top":Y,"long-sleeve":Y,"base-layer":Y,"mid-layer":Y,jacket:B,vest:Y,windbreaker:B,"rain-jacket":F,shorts:R.A,capris:R.A,tights:R.A,pants:R.A,gloves:_,mittens:_,socks:R.A,shoes:R.A,gaiter:I,balaclava:I,accessory:H},q=e=>{let a=e.toLowerCase().trim().replace("-"," ");return V[a]?V[a]:a.includes("shirt")||a.includes("top")?Y:a.includes("short")||a.includes("pant")||a.includes("tight")?R.A:a.includes("jacket")?B:a.includes("hat")||a.includes("cap")||a.includes("beanie")||a.includes("head")?I:V[a]||j};function J(e){let{suggestion:a}=e;return"string"==typeof a?(0,r.jsxs)(o.Zp,{className:"shadow-md",children:[(0,r.jsx)(o.aR,{children:(0,r.jsxs)(o.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(Y,{className:"mr-2 h-6 w-6 text-primary"}),"Dress Your Run"]})}),(0,r.jsxs)(o.Wu,{children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:"Clothing suggestions are in an unexpected format."}),(0,r.jsxs)("p",{className:"text-sm mt-2",children:["Raw suggestion: ",a]})]})]}):a&&0!==a.length?(0,r.jsxs)(o.Zp,{className:"shadow-md",children:[(0,r.jsx)(o.aR,{children:(0,r.jsxs)(o.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(Y,{className:"mr-2 h-6 w-6 text-primary"}),"Dress Your Run"]})}),(0,r.jsxs)(o.Wu,{children:[(0,r.jsx)("ul",{className:"space-y-3",children:a.map((e,a)=>{if("object"!=typeof e||!e||"string"!=typeof e.item||"string"!=typeof e.category)return(0,r.jsxs)("li",{className:"flex items-center text-base text-destructive",children:[(0,r.jsx)(j,{className:"mr-3 h-5 w-5 text-destructive shrink-0"}),(0,r.jsx)("span",{children:"Malformed clothing item data."})]},"malformed-".concat(a));let t=q(e.category);return(0,r.jsxs)("li",{className:"flex items-center text-base",children:[(0,r.jsx)(t,{className:"mr-3 h-5 w-5 text-primary shrink-0"}),(0,r.jsx)("span",{children:e.item})]},a)})}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground italic pt-3",children:"Based on conditions around the recommended run time."})]})]}):(0,r.jsxs)(o.Zp,{className:"shadow-md",children:[(0,r.jsx)(o.aR,{children:(0,r.jsxs)(o.ZB,{className:"flex items-center text-xl font-semibold",children:[(0,r.jsx)(Y,{className:"mr-2 h-6 w-6 text-primary"}),"Dress Your Run"]})}),(0,r.jsx)(o.Wu,{children:(0,r.jsx)("p",{className:"text-muted-foreground",children:null===a?"Clothing suggestion is being generated...":"No specific clothing suggestions available at this time. This could be due to unavailable weather data or the AI not providing details."})})]})}var G=t(5388);let $="cachedNewsletterData",K=e=>({name:e.name,location:e.location,weatherUnit:e.weatherUnit,runningLevel:e.runningLevel,trainingPlan:e.trainingPlan,planStartDate:e.planStartDate,raceDate:e.raceDate,newsSearchPreferences:e.newsSearchPreferences?[...e.newsSearchPreferences].sort():[]});function Q(){let{userProfile:e,loading:a,isProfileComplete:t}=(0,n.s)(),[s,o]=(0,u.useState)(null),[i,c]=(0,u.useState)(!0),[d,m]=(0,u.useState)(null),[g,y]=(0,u.useState)(null),j=(0,u.useCallback)(async(a,t)=>{if(!e.name||!e.location||!e.weatherUnit){m("Please complete your profile including name, location, and weather unit to load the dashboard."),o(null),c(!1);return}c(!0),m(null),y(null),console.log("[Orchestrator] Starting to fetch fresh newsletter data for date:",a);try{let r;let s=(0,f.iy)(e);console.log("[Orchestrator] Today's workout:",s);let n="C"===e.weatherUnit?"metric":"imperial",l=await x(e.location,n);console.log("[Orchestrator] Weather service result:",l),"error"in l?(console.warn("[Orchestrator] Weather service returned an error:",l.error),r={error:l.error},y(l.error)):(r=l,l.error&&(console.warn("[Orchestrator] Weather data processed with an internal error message:",l.error),r={...l,error:l.error},y(l.error)));let i="General Fitness";if(e.trainingPlan){let a=D.CY.find(a=>a.value===e.trainingPlan);i=a?a.label.replace(" Plan","").replace(" Race",""):e.trainingPlan}let c={userName:e.name,location:e.location,runningLevel:e.runningLevel||"beginner",trainingPlanType:e.trainingPlan||"5k",raceDistance:i,workout:s,weather:r,weatherUnit:e.weatherUnit||"F",newsSearchPreferences:e.newsSearchPreferences||[]};console.log("[Orchestrator] Input for customizeNewsletter AI flow:",JSON.stringify(c,null,2));let d=await p(c);console.log("[Orchestrator] Result from customizeNewsletter AI flow:",JSON.stringify(d,null,2)),localStorage.setItem($,JSON.stringify({data:d,fetchedDate:a,profileSnapshot:t})),console.log("[Orchestrator] Newsletter data cached successfully with snapshot:",t),o(d)}catch(t){var r,s,n,l;console.error("[Orchestrator] Error fetching personalized newsletter data:",t);let e="Could not load your personalized dashboard. ";t.message?e+=t.message:"string"==typeof t?e+=t:e+="An unknown error occurred processing your dashboard content.";let a=(null===(r=t.message)||void 0===r?void 0:r.toLowerCase().includes("ai"))||(null===(s=t.message)||void 0===s?void 0:s.toLowerCase().includes("flow"))||(null===(n=t.message)||void 0===n?void 0:n.toLowerCase().includes("tool"))||(null===(l=t.message)||void 0===l?void 0:l.toLowerCase().includes("genkit"));g&&a?m("Failed to process data due to an AI or tool error. This might be related to weather data or news search. Weather service message: ".concat(g,". AI error: ").concat(t.message,". Full details: ").concat(e)):a?m("An error occurred with the AI content generation service: ".concat(t.message,". Full details: ").concat(e)):m(e),o(null)}finally{console.log("[Orchestrator] Finished fetching newsletter data. Setting orchestrator loading to false."),c(!1)}},[e]);return((0,u.useEffect)(()=>{if(a){console.log("[Orchestrator] Waiting for user profile to load..."),c(!0);return}if(console.log("[Orchestrator] User profile loaded. isProfileComplete:",t,"Profile:",e),!t){console.log("[Orchestrator] Profile is not complete. Prompting user."),m("Please complete your profile fully (including name, location, weather unit, and training plan selections) to load the dashboard."),o(null),c(!1);return}d&&d.startsWith("Please complete your profile")&&(console.log("[Orchestrator] Profile is now complete, clearing previous 'incomplete profile' error."),m(null));let r=(0,G.GP)(new Date,"yyyy-MM-dd"),s=K(e),n=!1;console.log("[Orchestrator] useEffect for cache check. Today:",r),console.log("[Orchestrator] Current Profile Snapshot for cache check:",s);let l=localStorage.getItem($);if(l)try{var i;let e=JSON.parse(l);console.log("[Orchestrator] Found cached entry:",e);let a=e.profileSnapshot.name===s.name&&e.profileSnapshot.location===s.location&&e.profileSnapshot.weatherUnit===s.weatherUnit&&e.profileSnapshot.runningLevel===s.runningLevel&&e.profileSnapshot.trainingPlan===s.trainingPlan&&e.profileSnapshot.planStartDate===s.planStartDate&&e.profileSnapshot.raceDate===s.raceDate&&JSON.stringify(e.profileSnapshot.newsSearchPreferences)===JSON.stringify(s.newsSearchPreferences),t="string"==typeof(null===(i=e.data)||void 0===i?void 0:i.weather)&&(e.data.weather.toLowerCase().includes("unavailable")||e.data.weather.toLowerCase().includes("error")||e.data.weather.toLowerCase().includes("could not retrieve"));console.log("[Orchestrator] Cache check: Fetched Date Match: ".concat(e.fetchedDate===r," (Cached: ").concat(e.fetchedDate,", Today: ").concat(r,")")),console.log("[Orchestrator] Cache check: Profile Snapshots Match: ".concat(a)),console.log("[Orchestrator] Cache check: Weather Was Unavailable In Cache: ".concat(t)),e.fetchedDate===r&&a&&!t?(console.log("[Orchestrator] Using valid cached newsletter data for today (weather available)."),o(e.data),c(!1),m(null),n=!0):(console.log("[Orchestrator] Cache is stale or weather was unavailable/errored. Will attempt to fetch fresh data."),e.fetchedDate!==r&&console.log("  - Cache Invalidation Reason: Date mismatch (Cached: ".concat(e.fetchedDate,", Today: ").concat(r,")")),a||(console.log("  - Cache Invalidation Reason: Profile snapshot mismatch."),Object.keys(s).forEach(a=>{let t=s[a],r=e.profileSnapshot[a];JSON.stringify(t)!==JSON.stringify(r)&&console.log("    Mismatch on key '".concat(a,"': Current='").concat(JSON.stringify(t),"', Cached='").concat(JSON.stringify(r),"'"))})),t&&console.log("  - Cache Invalidation Reason: Cached weather was unavailable or errored. Attempting refresh."))}catch(e){console.error("[Orchestrator] Error parsing cached newsletter data:",e),localStorage.removeItem($)}else console.log("[Orchestrator] No cache found. Will fetch fresh data.");n||(console.log("[Orchestrator] Proceeding to fetch fresh newsletter data because cache was not used."),j(r,s))},[a,t,e,j,d]),a||i&&!s&&!d)?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(l.E,{className:"h-28 w-full"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(l.E,{className:"h-64 w-full"}),(0,r.jsx)(l.E,{className:"h-48 w-full"})]}),(0,r.jsx)(l.E,{className:"h-48 w-full"}),(0,r.jsx)(l.E,{className:"h-72 w-full"})]}):d?(0,r.jsxs)(C,{variant:"destructive",className:"mt-6",children:[(0,r.jsx)(h.A,{className:"h-5 w-5"}),(0,r.jsx)(O,{children:"Error Loading Dashboard"}),(0,r.jsx)(W,{children:d})]}):i||s?s?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(w,{greetingWithName:s.greeting}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(S,{location:e.location,weatherString:s.weather}),(0,r.jsx)(L,{userProfile:e,workoutSuggestion:s.workout,planEndNotification:s.planEndNotification})]}),(0,r.jsx)(J,{suggestion:s.dressMyRunSuggestion}),(0,r.jsx)(U,{topStories:s.topStories})]}):(0,r.jsx)("div",{className:"text-center py-10",children:"Preparing your dashboard... If this takes too long, please refresh or check back later."}):(0,r.jsxs)(C,{variant:"default",className:"mt-6 border-primary/50 text-primary-foreground bg-primary/10",children:[(0,r.jsx)(h.A,{className:"h-5 w-5 text-primary"}),(0,r.jsx)(O,{className:"text-primary",children:"Dashboard Content Unavailable"}),(0,r.jsxs)(W,{className:"text-foreground",children:["We are having trouble generating your personalized content at the moment. This could be due to:",(0,r.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,r.jsx)("li",{children:"Your profile not being fully completed (check all fields, especially name, location, weather unit, and training plan selections)."}),(0,r.jsx)("li",{children:"Temporary issues with external services (weather, news search). Please ensure API keys are correctly set in the environment if you are the developer."}),(0,r.jsx)("li",{children:"Temporary issues with the AI content generation service."})]}),"Please ensure your profile is complete and try refreshing. If the issue persists, please try again later.",g&&(0,r.jsxs)("p",{className:"mt-2 font-semibold",children:["Specific weather service message: ",g]})]})]})}function X(){let{loading:e,isProfileComplete:a}=(0,n.s)();return e?(0,r.jsx)(s.O,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(l.E,{className:"h-28 w-full"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsx)(l.E,{className:"h-48 w-full"}),(0,r.jsx)(l.E,{className:"h-48 w-full"})]}),(0,r.jsx)(l.E,{className:"h-72 w-full"})]})}):a?(0,r.jsx)(s.O,{children:(0,r.jsx)(Q,{})}):(0,r.jsx)(s.O,{children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-200px)]",children:(0,r.jsxs)(o.Zp,{className:"w-full max-w-md text-center shadow-xl",children:[(0,r.jsxs)(o.aR,{children:[(0,r.jsx)(h.A,{className:"mx-auto h-12 w-12 text-primary"}),(0,r.jsx)(o.ZB,{className:"text-2xl mt-4",children:"Welcome to Shut Up and Run!"}),(0,r.jsx)(o.BT,{className:"mt-2",children:"To get your personalized running dashboard, please complete your profile with all required fields."})]}),(0,r.jsx)(o.Wu,{children:(0,r.jsx)(i.$,{asChild:!0,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:(0,r.jsx)(d(),{href:"/profile",children:"Complete Your Profile"})})})]})})})}},6424:(e,a,t)=>{"use strict";t.d(a,{F:()=>o});var r=t(5155),s=t(2115),n=t(7655),l=t(9434);let o=s.forwardRef((e,a)=>{let{className:t,children:s,...o}=e;return(0,r.jsxs)(n.bL,{ref:a,className:(0,l.cn)("relative overflow-hidden",t),...o,children:[(0,r.jsx)(n.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,r.jsx)(i,{}),(0,r.jsx)(n.OK,{})]})});o.displayName=n.bL.displayName;let i=s.forwardRef((e,a)=>{let{className:t,orientation:s="vertical",...o}=e;return(0,r.jsx)(n.VM,{ref:a,orientation:s,className:(0,l.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...o,children:(0,r.jsx)(n.lr,{className:"relative flex-1 rounded-full bg-border"})})});i.displayName=n.VM.displayName},7387:(e,a,t)=>{Promise.resolve().then(t.bind(t,5369))},8856:(e,a,t)=>{"use strict";t.d(a,{E:()=>n});var r=t(5155),s=t(9434);function n(e){let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,s.cn)("animate-pulse rounded-md bg-muted",a),...t})}}},e=>{var a=a=>e(e.s=a);e.O(0,[324,868,166,13,950,441,684,358],()=>a(7387)),_N_E=e.O()}]);